{
  "hash": "8cc92654a6b4d99cfab7dd91cf7a1659",
  "result": {
    "markdown": "---\ntitle: \"Lab 3\"\n#author: \"Insert Name\"\ndate: \"Math 241, Week 3\"\noutput:\n  pdf_document\nurlcolor: blue\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibs <- c('tidyverse','knitr','viridis', 'mosaic', 'Lahman', \"readr\", \"dplyr\", \"tidyr\", \"ggplot2\")\nfor(l in libs){\n  if(!require(l,character.only = TRUE, quietly = TRUE)){\n    message( sprintf('Did not have the required package << %s >> installed. Downloading now ... ',l))\n    install.packages(l) \n  }\n  library(l, character.only = TRUE, quietly = TRUE)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_science <- read_csv(file = \"data/jobs_in_data.csv\", show_col_types = FALSE)\ndim(data_science)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 9355   12\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_science$job_title <- as.factor(data_science$job_title)\ndata_science$experience_level <- as.factor(data_science$experience_level)\ndata_science$employment_type <- as.factor(data_science$employment_type)\ndata_science$work_setting <- as.factor(data_science$work_setting)\ndata_science$company_size <- as.factor(data_science$company_size)\n\n\nmodel <- lm(salary ~ job_title + experience_level + employment_type + work_setting + company_size, data = data_science)\n\n# Summarize the model\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ job_title + experience_level + employment_type + \n    work_setting + company_size, data = data_science)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-168172  -35547   -4480   29442  346253 \n\nCoefficients:\n                                                  Estimate Std. Error t value\n(Intercept)                                         159452      21343   7.471\njob_titleAI Developer                               -68886      19915  -3.459\njob_titleAI Engineer                                -63921      17779  -3.595\njob_titleAI Programmer                             -118422      28466  -4.160\njob_titleAI Research Engineer                      -130522      30818  -4.235\njob_titleAI Scientist                               -81106      19957  -4.064\njob_titleAnalytics Engineer                         -87465      15750  -5.553\njob_titleAnalytics Engineering Manager              118403      55646   2.128\njob_titleApplied Data Scientist                     -87930      22314  -3.941\njob_titleApplied Machine Learning Engineer          -77593      34465  -2.251\njob_titleApplied Machine Learning Scientist         -92927      21932  -4.237\njob_titleApplied Scientist                          -47880      15752  -3.040\njob_titleAutonomous Vehicle Technician              -67025      41882  -1.600\njob_titleAWS Data Architect                          59246      55533   1.067\njob_titleAzure Data Engineer                        -83581      40825  -2.047\njob_titleBI Analyst                                 -95138      18305  -5.197\njob_titleBI Data Analyst                           -119281      20424  -5.840\njob_titleBI Data Engineer                          -129334      55548  -2.328\njob_titleBI Developer                              -118456      17082  -6.935\njob_titleBig Data Architect                        -100424      40767  -2.463\njob_titleBig Data Engineer                         -102550      24438  -4.196\njob_titleBusiness Data Analyst                     -118087      20026  -5.897\njob_titleBusiness Intelligence Analyst             -109963      17023  -6.460\njob_titleBusiness Intelligence Data Analyst         -80218      40805  -1.966\njob_titleBusiness Intelligence Developer           -133117      20101  -6.622\njob_titleBusiness Intelligence Engineer             -91558      16039  -5.709\njob_titleBusiness Intelligence Manager              -72327      40743  -1.775\njob_titleBusiness Intelligence Specialist           -88074      30786  -2.861\njob_titleCloud Data Architect                        43403      55646   0.780\njob_titleCloud Data Engineer                        -46790      30886  -1.515\njob_titleCloud Database Engineer                    -87534      28383  -3.084\njob_titleCompliance Data Analyst                   -135761      40841  -3.324\njob_titleComputer Vision Engineer                   -52078      18758  -2.776\njob_titleComputer Vision Software Engineer          -86764      28579  -3.036\njob_titleConsultant Data Engineer                   -83447      57237  -1.458\njob_titleData Analyst                              -123459      15466  -7.983\njob_titleData Analytics Consultant                  -66494      41696  -1.595\njob_titleData Analytics Engineer                   -138241      28405  -4.867\njob_titleData Analytics Lead                        -24402      34419  -0.709\njob_titleData Analytics Manager                     -84105      17665  -4.761\njob_titleData Analytics Specialist                 -155688      40711  -3.824\njob_titleData Architect                             -79551      15822  -5.028\njob_titleData Developer                            -118042      26674  -4.425\njob_titleData DevOps Engineer                      -105818      40972  -2.583\njob_titleData Engineer                              -92575      15435  -5.998\njob_titleData Infrastructure Engineer               -34859      21770  -1.601\njob_titleData Integration Engineer                 -126249      40718  -3.101\njob_titleData Integration Specialist                -95304      22990  -4.146\njob_titleData Lead                                  -69556      21013  -3.310\njob_titleData Management Analyst                   -133334      40808  -3.267\njob_titleData Management Specialist                -142755      28374  -5.031\njob_titleData Manager                              -125302      16090  -7.788\njob_titleData Modeler                              -116428      19134  -6.085\njob_titleData Modeller                             -146266      40736  -3.591\njob_titleData Operations Analyst                   -147829      22828  -6.476\njob_titleData Operations Engineer                  -100191      20368  -4.919\njob_titleData Operations Manager                   -108249      40718  -2.659\njob_titleData Operations Specialist                -173652      30784  -5.641\njob_titleData Product Manager                       -98707      24338  -4.056\njob_titleData Product Owner                        -141266      40736  -3.468\njob_titleData Quality Analyst                      -148423      19476  -7.621\njob_titleData Quality Engineer                     -122686      34440  -3.562\njob_titleData Science Consultant                   -124682      17376  -7.175\njob_titleData Science Director                      -72334      30962  -2.336\njob_titleData Science Engineer                      -85243      20985  -4.062\njob_titleData Science Lead                          -55236      19494  -2.833\njob_titleData Science Manager                       -41361      16403  -2.522\njob_titleData Science Practitioner                 -106208      22829  -4.652\njob_titleData Science Tech Lead                     168403      55646   3.026\njob_titleData Scientist                             -81648      15440  -5.288\njob_titleData Scientist Lead                        -68675      40794  -1.683\njob_titleData Specialist                           -124962      17560  -7.116\njob_titleData Strategist                           -145218      19872  -7.308\njob_titleData Strategy Manager                     -105499      30786  -3.427\njob_titleData Visualization Analyst                -130688      40711  -3.210\njob_titleData Visualization Engineer               -127713      30778  -4.150\njob_titleData Visualization Specialist             -128413      30778  -4.172\njob_titleDecision Scientist                         -79202      17658  -4.485\njob_titleDeep Learning Engineer                     -25564      21777  -1.174\njob_titleDeep Learning Researcher                  -127115      55512  -2.290\njob_titleDirector of Data Science                   -39486      18510  -2.133\njob_titleETL Developer                             -115538      19872  -5.814\njob_titleETL Engineer                              -148577      40743  -3.647\njob_titleFinance Data Analyst                       -78060      34756  -2.246\njob_titleFinancial Data Analyst                     -88596      30878  -2.869\njob_titleHead of Data                               -54492      18172  -2.999\njob_titleHead of Data Science                       -76306      22464  -3.397\njob_titleHead of Machine Learning                   -14334      40851  -0.351\njob_titleInsight Analyst                           -172031      24374  -7.058\njob_titleLead Data Analyst                         -104874      34476  -3.042\njob_titleLead Data Engineer                         -68016      26850  -2.533\njob_titleLead Data Scientist                        -93446      24431  -3.825\njob_titleLead Machine Learning Engineer            -144802      34446  -4.204\njob_titleMachine Learning Developer                -105120      24501  -4.290\njob_titleMachine Learning Engineer                  -56780      15486  -3.667\njob_titleMachine Learning Infrastructure Engineer   -85465      18500  -4.620\njob_titleMachine Learning Manager                   -75943      30802  -2.465\njob_titleMachine Learning Modeler                   -77338      40711  -1.900\njob_titleMachine Learning Operations Engineer      -175676      55516  -3.164\njob_titleMachine Learning Research Engineer        -122864      30870  -3.980\njob_titleMachine Learning Researcher                -72914      20151  -3.618\njob_titleMachine Learning Scientist                 -59485      16568  -3.590\njob_titleMachine Learning Software Engineer         -29623      21343  -1.388\njob_titleMachine Learning Specialist               -152327      40743  -3.739\njob_titleManager Data Management                   -110676      55516  -1.994\njob_titleManaging Director Data Science              41677      55618   0.749\njob_titleMarketing Data Analyst                     -84858      40793  -2.080\njob_titleMarketing Data Engineer                    -61682      55674  -1.108\njob_titleML Engineer                                -36567      16247  -2.251\njob_titleMLOps Engineer                             -83701      22278  -3.757\njob_titleNLP Engineer                               -93296      21806  -4.278\njob_titlePower BI Developer                        -138754      55533  -2.499\njob_titlePrincipal Data Analyst                     -85684      40783  -2.101\njob_titlePrincipal Data Engineer                    -84725      34416  -2.462\njob_titlePrincipal Data Scientist                   -47378      22897  -2.069\njob_titlePrincipal Machine Learning Engineer        -44316      34478  -1.285\njob_titleProduct Data Analyst                      -108702      28568  -3.805\njob_titleResearch Analyst                          -134003      17616  -7.607\njob_titleResearch Engineer                          -54289      16027  -3.387\njob_titleResearch Scientist                         -50092      15735  -3.183\njob_titleSales Data Analyst                        -161536      57226  -2.823\njob_titleSoftware Data Engineer                     -77570      34940  -2.220\njob_titleStaff Data Analyst                        -116636      34768  -3.355\njob_titleStaff Data Scientist                       -99095      41383  -2.395\njob_titleStaff Machine Learning Engineer            -30170      55661  -0.542\nexperience_levelExecutive                            77562       4474  17.335\nexperience_levelMid-level                            17993       2845   6.325\nexperience_levelSenior                               54915       2694  20.382\nemployment_typeFreelance                            -64661      22183  -2.915\nemployment_typeFull-time                             -7771      13987  -0.556\nemployment_typePart-time                             -5886      19672  -0.299\nwork_settingIn-person                                35518       4465   7.954\nwork_settingRemote                                   29079       4470   6.505\ncompany_sizeM                                         8573       2419   3.544\ncompany_sizeS                                       -26635       5006  -5.321\n                                                  Pr(>|t|)    \n(Intercept)                                       8.68e-14 ***\njob_titleAI Developer                             0.000545 ***\njob_titleAI Engineer                              0.000326 ***\njob_titleAI Programmer                            3.21e-05 ***\njob_titleAI Research Engineer                     2.31e-05 ***\njob_titleAI Scientist                             4.86e-05 ***\njob_titleAnalytics Engineer                       2.88e-08 ***\njob_titleAnalytics Engineering Manager            0.033383 *  \njob_titleApplied Data Scientist                   8.19e-05 ***\njob_titleApplied Machine Learning Engineer        0.024387 *  \njob_titleApplied Machine Learning Scientist       2.29e-05 ***\njob_titleApplied Scientist                        0.002376 ** \njob_titleAutonomous Vehicle Technician            0.109558    \njob_titleAWS Data Architect                       0.286057    \njob_titleAzure Data Engineer                      0.040656 *  \njob_titleBI Analyst                               2.07e-07 ***\njob_titleBI Data Analyst                          5.39e-09 ***\njob_titleBI Data Engineer                         0.019916 *  \njob_titleBI Developer                             4.35e-12 ***\njob_titleBig Data Architect                       0.013783 *  \njob_titleBig Data Engineer                        2.74e-05 ***\njob_titleBusiness Data Analyst                    3.84e-09 ***\njob_titleBusiness Intelligence Analyst            1.10e-10 ***\njob_titleBusiness Intelligence Data Analyst       0.049340 *  \njob_titleBusiness Intelligence Developer          3.73e-11 ***\njob_titleBusiness Intelligence Engineer           1.17e-08 ***\njob_titleBusiness Intelligence Manager            0.075901 .  \njob_titleBusiness Intelligence Specialist         0.004235 ** \njob_titleCloud Data Architect                     0.435426    \njob_titleCloud Data Engineer                      0.129833    \njob_titleCloud Database Engineer                  0.002048 ** \njob_titleCompliance Data Analyst                  0.000890 ***\njob_titleComputer Vision Engineer                 0.005510 ** \njob_titleComputer Vision Software Engineer        0.002405 ** \njob_titleConsultant Data Engineer                 0.144897    \njob_titleData Analyst                             1.60e-15 ***\njob_titleData Analytics Consultant                0.110800    \njob_titleData Analytics Engineer                  1.15e-06 ***\njob_titleData Analytics Lead                      0.478357    \njob_titleData Analytics Manager                   1.96e-06 ***\njob_titleData Analytics Specialist                0.000132 ***\njob_titleData Architect                           5.05e-07 ***\njob_titleData Developer                           9.74e-06 ***\njob_titleData DevOps Engineer                     0.009819 ** \njob_titleData Engineer                            2.08e-09 ***\njob_titleData Infrastructure Engineer             0.109353    \njob_titleData Integration Engineer                0.001937 ** \njob_titleData Integration Specialist              3.42e-05 ***\njob_titleData Lead                                0.000936 ***\njob_titleData Management Analyst                  0.001090 ** \njob_titleData Management Specialist               4.97e-07 ***\njob_titleData Manager                             7.56e-15 ***\njob_titleData Modeler                             1.21e-09 ***\njob_titleData Modeller                            0.000332 ***\njob_titleData Operations Analyst                  9.92e-11 ***\njob_titleData Operations Engineer                 8.84e-07 ***\njob_titleData Operations Manager                  0.007862 ** \njob_titleData Operations Specialist               1.74e-08 ***\njob_titleData Product Manager                     5.04e-05 ***\njob_titleData Product Owner                       0.000527 ***\njob_titleData Quality Analyst                     2.77e-14 ***\njob_titleData Quality Engineer                    0.000369 ***\njob_titleData Science Consultant                  7.77e-13 ***\njob_titleData Science Director                    0.019499 *  \njob_titleData Science Engineer                    4.90e-05 ***\njob_titleData Science Lead                        0.004615 ** \njob_titleData Science Manager                     0.011699 *  \njob_titleData Science Practitioner                3.33e-06 ***\njob_titleData Science Tech Lead                   0.002483 ** \njob_titleData Scientist                           1.26e-07 ***\njob_titleData Scientist Lead                      0.092322 .  \njob_titleData Specialist                          1.19e-12 ***\njob_titleData Strategist                          2.94e-13 ***\njob_titleData Strategy Manager                    0.000613 ***\njob_titleData Visualization Analyst               0.001331 ** \njob_titleData Visualization Engineer              3.36e-05 ***\njob_titleData Visualization Specialist            3.04e-05 ***\njob_titleDecision Scientist                       7.37e-06 ***\njob_titleDeep Learning Engineer                   0.240482    \njob_titleDeep Learning Researcher                 0.022053 *  \njob_titleDirector of Data Science                 0.032928 *  \njob_titleETL Developer                            6.30e-09 ***\njob_titleETL Engineer                             0.000267 ***\njob_titleFinance Data Analyst                     0.024731 *  \njob_titleFinancial Data Analyst                   0.004125 ** \njob_titleHead of Data                             0.002719 ** \njob_titleHead of Data Science                     0.000685 ***\njob_titleHead of Machine Learning                 0.725671    \njob_titleInsight Analyst                          1.81e-12 ***\njob_titleLead Data Analyst                        0.002357 ** \njob_titleLead Data Engineer                       0.011320 *  \njob_titleLead Data Scientist                      0.000132 ***\njob_titleLead Machine Learning Engineer           2.65e-05 ***\njob_titleMachine Learning Developer               1.80e-05 ***\njob_titleMachine Learning Engineer                0.000247 ***\njob_titleMachine Learning Infrastructure Engineer 3.89e-06 ***\njob_titleMachine Learning Manager                 0.013700 *  \njob_titleMachine Learning Modeler                 0.057509 .  \njob_titleMachine Learning Operations Engineer     0.001559 ** \njob_titleMachine Learning Research Engineer       6.95e-05 ***\njob_titleMachine Learning Researcher              0.000298 ***\njob_titleMachine Learning Scientist               0.000332 ***\njob_titleMachine Learning Software Engineer       0.165185    \njob_titleMachine Learning Specialist              0.000186 ***\njob_titleManager Data Management                  0.046227 *  \njob_titleManaging Director Data Science           0.453670    \njob_titleMarketing Data Analyst                   0.037533 *  \njob_titleMarketing Data Engineer                  0.267930    \njob_titleML Engineer                              0.024425 *  \njob_titleMLOps Engineer                           0.000173 ***\njob_titleNLP Engineer                             1.90e-05 ***\njob_titlePower BI Developer                       0.012486 *  \njob_titlePrincipal Data Analyst                   0.035671 *  \njob_titlePrincipal Data Engineer                  0.013843 *  \njob_titlePrincipal Data Scientist                 0.038561 *  \njob_titlePrincipal Machine Learning Engineer      0.198696    \njob_titleProduct Data Analyst                     0.000143 ***\njob_titleResearch Analyst                         3.08e-14 ***\njob_titleResearch Engineer                        0.000709 ***\njob_titleResearch Scientist                       0.001460 ** \njob_titleSales Data Analyst                       0.004771 ** \njob_titleSoftware Data Engineer                   0.026435 *  \njob_titleStaff Data Analyst                       0.000798 ***\njob_titleStaff Data Scientist                     0.016660 *  \njob_titleStaff Machine Learning Engineer          0.587807    \nexperience_levelExecutive                          < 2e-16 ***\nexperience_levelMid-level                         2.65e-10 ***\nexperience_levelSenior                             < 2e-16 ***\nemployment_typeFreelance                          0.003567 ** \nemployment_typeFull-time                          0.578535    \nemployment_typePart-time                          0.764772    \nwork_settingIn-person                             2.02e-15 ***\nwork_settingRemote                                8.18e-11 ***\ncompany_sizeM                                     0.000396 ***\ncompany_sizeS                                     1.06e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 53300 on 9220 degrees of freedom\nMultiple R-squared:  0.308,\tAdjusted R-squared:  0.2979 \nF-statistic: 30.62 on 134 and 9220 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nexp_salary <- data_science %>%\n  group_by(experience_level) %>%\n  summarize(avg_salary = mean(salary, na.rm = TRUE))\n\nemployment_salary <- data_science %>%\n  group_by(employment_type) %>%\n  summarize(avg_salary = mean(salary, na.rm = TRUE))\n\nwork_salary <- data_science %>%\n  group_by(work_setting) %>%\n  summarize(avg_salary = mean(salary, na.rm = TRUE))\n\ncompany_salary <- data_science %>%\n  group_by(company_size) %>%\n  summarize(avg_salary = mean(salary, na.rm = TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(cowplot)\n\n# Plot 1: Average Salary by Experience Level\nplot1 <- ggplot(data = exp_salary, aes(x = experience_level, y = avg_salary)) +\n  geom_bar(stat = \"identity\", fill = \"lightgreen\") +\n  theme_minimal() +\n  labs(title = \"Average Salary by Experience Level\",\n       x = \"Experience Level\",\n       y = \"Average Salary\")\n\n# Plot 2: Average Salary by Employment Type\nplot2 <- ggplot(data = employment_salary, aes(x = employment_type, y = avg_salary)) +\n  geom_bar(stat = \"identity\", fill = \"lightcoral\") +\n  theme_minimal() +\n  labs(title = \"Average Salary by Employment Type\",\n       x = \"Employment Type\",\n       y = \"Average Salary\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n#  work setting \n\n# Plot 3: Average Salary by Work Setting\nplot3 <- ggplot(data = work_salary, aes(x = work_setting, y = avg_salary)) +\n  geom_bar(stat = \"identity\", fill = \"lightpink\") +\n  theme_minimal() +\n  labs(title = \"Average Salary by Work Setting\",\n       x = \"Work Setting\",\n       y = \"Average Salary\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  scale_x_discrete(labels = c(\"Remote\" = \"Remote\", \"Hybrid\" = \"Hybrid\", \"In-Person\" = \"In-Person\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<ggproto object: Class ScaleDiscretePosition, ScaleDiscrete, Scale, gg>\n    aesthetics: x xmin xmax xend\n    axis_order: function\n    break_info: function\n    break_positions: function\n    breaks: waiver\n    call: call\n    clone: function\n    dimension: function\n    drop: TRUE\n    expand: waiver\n    get_breaks: function\n    get_breaks_minor: function\n    get_labels: function\n    get_limits: function\n    guide: waiver\n    is_discrete: function\n    is_empty: function\n    labels: Remote Hybrid In-Person\n    limits: NULL\n    make_sec_title: function\n    make_title: function\n    map: function\n    map_df: function\n    n.breaks.cache: NULL\n    na.translate: TRUE\n    na.value: NA\n    name: waiver\n    palette: function\n    palette.cache: NULL\n    position: bottom\n    range: environment\n    range_c: environment\n    rescale: function\n    reset: function\n    scale_name: position_d\n    train: function\n    train_df: function\n    transform: function\n    transform_df: function\n    super:  <ggproto object: Class ScaleDiscretePosition, ScaleDiscrete, Scale, gg>\n```\n:::\n\n```{.r .cell-code}\n# Plot 4: Average Salary by Company Size\nplot4 <- ggplot(data = company_salary, aes(x = factor(company_size, levels = c(\"S\", \"M\", \"L\")), y = avg_salary)) +\n  geom_bar(stat = \"identity\", fill = \"lightblue\") +\n  theme_minimal() +\n  labs(title = \"Average Salary by Company Size\",\n       x = \"Company Size\",\n       y = \"Average Salary\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_x_discrete(labels = c(\"S\" = \"Small\", \"M\" = \"Medium\", \"L\" = \"Large\"))\n\n# Arrange the plots in a grid\ncombined_plot <- plot_grid(plot1, plot2, plot3, plot4, ncol = 2)\n\n# Print the combined plot\ncombined_plot\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# gets ride of extra titles\njob_title_counts <- data_science %>%\n  count(job_title)\n\nother_jobs <- job_title_counts %>%\n  filter(n < 100) %>%\n  pull(job_title)\n\ndata_science_grouped <- data_science %>%\n  mutate(job_title_grouped = if_else(job_title %in% other_jobs, \"Other\", job_title))\n\n#frequency of titles \nggplot(data = data_science_grouped, aes(x = job_title_grouped)) +\n  geom_bar(fill = \"skyblue\", color = \"black\") +\n  theme_minimal() +\n  labs(title = \"Distribution of Job Titles (Grouped)\",\n       x = \"Job Title\",\n       y = \"Frequency\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\navg_salary_by_job <- data_science_grouped %>%\n  group_by(job_title_grouped) %>%\n  summarize(avg_salary = mean(salary, na.rm = TRUE))\n\nggplot(data = avg_salary_by_job, aes(x = job_title_grouped, y = avg_salary)) +\n  geom_bar(stat = \"identity\", fill = \"skyblue\") +\n  theme_minimal() +\n  labs(title = \"Average Salary by Job Title\",\n       x = \"Job Title\",\n       y = \"Average Salary\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_science$job_title <- as.factor(data_science$job_title)\ndata_science$experience_level <- as.factor(data_science$experience_level)\ndata_science$employment_type <- as.factor(data_science$employment_type)\ndata_science$work_setting <- as.factor(data_science$work_setting)\ndata_science$company_size <- as.factor(data_science$company_size)\n\n\nmodel <- lm(salary ~  experience_level + employment_type + work_setting + company_size, data = data_science)\n\n# Summarize the model\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ experience_level + employment_type + work_setting + \n    company_size, data = data_science)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-178045  -39821   -6821   34339  330596 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                  78609      14281   5.504 3.80e-08 ***\nexperience_levelExecutive    94133       4416  21.315  < 2e-16 ***\nexperience_levelMid-level    21998       3013   7.301 3.08e-13 ***\nexperience_levelSenior       66910       2820  23.727  < 2e-16 ***\nemployment_typeFreelance    -62647      22173  -2.825  0.00473 ** \nemployment_typeFull-time     -8202      13559  -0.605  0.54524    \nemployment_typePart-time     -9770      20293  -0.481  0.63020    \nwork_settingIn-person        32231       4626   6.967 3.45e-12 ***\nwork_settingRemote           23104       4642   4.977 6.58e-07 ***\ncompany_sizeM                -3727       2332  -1.598  0.11011    \ncompany_sizeS               -29022       5202  -5.579 2.49e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 58450 on 9344 degrees of freedom\nMultiple R-squared:  0.1567,\tAdjusted R-squared:  0.1558 \nF-statistic: 173.6 on 10 and 9344 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n###### Q2\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotting the breakdown of job titles by employee residence\nggplot(data = data_science_grouped, aes(x = job_title_grouped, fill = employee_residence)) +\n  geom_bar(position = \"dodge\", color = \"black\") +\n  theme_minimal() +\n  labs(title = \"Job Title Breakdown by Employee Residence\",\n       x = \"Job Title\",\n       y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tmap)\n\navg_salary_by_country <- data_science %>%\n  group_by(company_location) %>%\n  summarize(avg_salary_in_usd = mean(salary_in_usd))\n\navg_salary_by_country <- avg_salary_by_country %>%\n  mutate(company_location = case_when(\n    company_location == \"Czech Republic\" ~ \"Czech Rep.\",\n    company_location == \"South Korea\" ~ \"Korea\",\n    company_location == \"Central African Republic\" ~ \"Central African Rep.\",\n    company_location == \"Bosnia and Herzegovina\" ~ \"Bosnia and Herz.\",\n    TRUE ~ company_location\n  ))\n\n\ndata(\"World\")\nworld_map <- merge(World, avg_salary_by_country, by.x = \"name\", by.y = \"company_location\", all.x = TRUE)\n\ntm_shape(world_map) +\n  tm_polygons(col = \"avg_salary_in_usd\", style = \"jenks\", palette = \"Blues\",\n              main.title = \"Average Salaries of Data Scientists by Country, 2020-2023\",\n              title = \"Average Salaries by Country (USD), 2020-2023\", legend.title = \"Salary Range\")\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotting the breakdown of job titles by experience level\nggplot(data = data_science_grouped, aes(x = job_title_grouped, fill = experience_level)) +\n  geom_bar(position = \"dodge\", color = \"black\") +\n  theme_minimal() +\n  labs(title = \"Job Title Breakdown by Experience Level\",\n       x = \"Job Title\",\n       y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plotting the breakdown of job titles by work setting\nggplot(data = data_science_grouped, aes(x = job_title_grouped, fill = work_setting)) +\n  geom_bar(position = \"dodge\", color = \"black\") +\n  theme_minimal() +\n  labs(title = \"Job Title Breakdown by Work Setting\",\n       x = \"Job Title\",\n       y = \"Count\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n:::\n\n\n\n###### Q3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the average salary for each job title and year\navg_salary_by_job_year <- data_science_grouped %>%\n  group_by(job_title_grouped, work_year) %>%\n  summarize(avg_salary = mean(salary, na.rm = TRUE))\n\n# Plotting the average salary for each job title by year\nggplot(data = avg_salary_by_job_year, aes(x = job_title_grouped, y = avg_salary, fill = factor(work_year))) +\n  geom_bar(stat = \"identity\", position = position_dodge(), color = \"black\") +\n  theme_minimal() +\n  labs(title = \"Average Salary by Job Title (Factored by Year)\",\n       x = \"Job Title\",\n       y = \"Average Salary\",\n       fill = \"Year\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = avg_salary_by_job_year, aes(x = work_year, y = avg_salary)) +\n  geom_bar(stat = \"identity\", position = position_dodge(), color = \"green\") +\n  theme_minimal() +\n  labs(title = \"Average Salary by Year\",\n       x = \"Year\",\n       y = \"Average Salary\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\navg_salary_by_employtype <- data_science %>% group_by(employment_type) %>% mutate(mean = mean(salary_in_usd))\nggplot(avg_salary_by_employtype, aes(x = work_year, y = mean)) + \n  geom_point() +\n  facet_wrap(~employment_type)\n```\n\n::: {.cell-output-display}\n![](proj1scracth_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "proj1scracth_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}